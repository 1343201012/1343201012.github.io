<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h2>Buy something...</h2>
    <button onclick="buy()">Buy</button>
    <div id="fb-ui-return-data"></div>
    <div id="fb-root"></div>

    <script src="http://connect.facebook.net/en_US/all.js"></script>

    <script>
        FB.init({appId: "YOUR_APP_ID", status: true, cookie: true});
        function buy() {
            var obj = {
                method: 'pay',
                action: 'buy_item',
                order_info: {'item_id': '1a'},
                dev_purchase_params: {'oscif': true}
            };

            FB.ui(obj,js_callback);
        }

        var js_callback = function(data) {
        if (data['order_id']) {　　　　　　// 当订单成功的时候，会返回商品在FB平台的商品id
          // Facebook only returns an order_id if you've implemented
          // the Credits Callback payments_status_update and settled
          // the user's placed order.

          // Notify the user that the purchased item has been delivered
          // without a complete reload of the game.
          write_callback_data(
                    "<br><b>Transaction Completed!</b> </br></br>"
                    + "Data returned from Facebook: </br>"
                    + "Order ID: " + data['order_id'] + "</br>"
                    + "Status: " + data['status']);
        } else if (data['error_code']) {　　　　// 出现某X非支付成功操作的时候，例如：点击支付窗口的取消按钮
          // Appropriately alert the user.
          write_callback_data(
                    "<br><b>Transaction Failed!</b> </br></br>"
                    + "Error message returned from Facebook:</br>"
                    + data['error_code'] + " - "
                    + data['error_message']);
        } else {　　　　　　　　　　　　// 其他未知名错误
          // Appropriately alert the user.
          write_callback_data("<br><b>Transaction failed!</b>");
        }
      };

      function write_callback_data(str) {
        document.getElementById('fb-ui-return-data').innerHTML=str;
      }
    </script>
</body>
</html>
